1. ![Alt](https://i.loli.net/2020/09/11/z7a5YnBcXeoUv1W.jpg)
2. 上图所示：上下文是一条加载指令，读取从物理地址4开始出的4字节字，CPU在执行这条指令的时候会生成一个有效的物理地址，通过内存总线将这个物理地址传递给主存，主存取出从物理地址4开始处的4个字节字，然后将其返回给CPU，CPU将其存放在一个寄存器中。

3. 现代处理器采用的是一个程序虚拟寻址（Virtual Addressing）的寻址方式，CPU通过生成一个虚拟地址（Virtual Address， VA）来访问主存，这个虚拟地址在被传送到主存之前会被先转换成一个物理地址。将虚拟地址转换成物理地址的任务称为地址翻译（Address Translation），地址翻译需要CPU硬件和操作系统之间的配合。CPU芯片上叫做内存管理单元（Memory Management Unit，MMU）的专用硬件，利用存放在主存中的查询表来动态翻译虚拟地址，该表的内容由操作系统管理。
4. ![Alt](https://i.loli.net/2020/09/11/f46shIdjneMG3xS.jpg)


5. 为了对内存中的存储单元进行识别，内存中的每个存储单元都必须有一个明确的地址，而一台计算机的处理器能访问多大的内存空间取决于处理器的程序计数器，该计数器的字长越长能访问的空间越大。

6. 例如：对于程序计数器位数为32位的处理器而言，地址发生器所能发出的地址数量位2的32次方约4G，因此处理器能访问的最大内存空间为4G，4G这个值又称为处理器的寻址空间或寻址能力。


7. ![Alt](https://i.loli.net/2020/09/11/PL8CVeFhtwEHDKR.jpg)

8. 在计算机技术中将内存中的程序段复制回辅存的做法叫做“换出”，而将辅存中程序段映射到内存的做法称为“换入”。经过不断有目的的换入和换出，处理器就可以运行一个大于实际物理内存的应用程序了。或者说，处理器似乎拥有了一个大于实际物理内存的内存空间。这个存储空间叫做虚拟内存空间，真正的内存空间称为实际物理内存空间。

9. 对于一台物理机，它的虚拟内存空间有多大呢？计算机虚拟内存空间的大小是由程序计数器的寻址能力所决定的。例如在程序计数器的位数为32的处理器中，它的虚拟内存空间为4GB。

10. 如果一个系统采用了虚拟内存技术，那么它就存在两个内存空间：虚拟内存空间、物理内存空间

11. 虚拟内存空间中的地址称为虚拟地址，实际物理内存空间中的地址称为实际物理地址或物理地址，处理器运算器和应用程序设计人员看到的只是虚拟内存空间和虚拟地址，而处理器片外的地址总线看到的只是物理地址空间和物理地址。

12. 由于存在两个内存地址因此一个应用程序从编写到执行，需要进行两次映射，第一次是映射到虚拟内存空间，第二次映射到物理内存空间。在计算机系统中，第二次映射的工作是由硬件和软件共同来完成的，承担这个任务的硬件部分叫做存储管理单元MMU，软件部分则是由操作系统的内存管理模块。


4. ![Alt](https://i.loli.net/2020/09/11/WlQjquVzsXb3mEK.jpg)

5. 综上所述，虚拟内存技术的实现是建立在应用程序可以分段，并且具有在任何时候正在使用的信息总是所有存储信息的一小部分的局部特性基础之上的，它是通过辅存空间模拟RAM来实现的一种使机器的作业地址空间大于实际内存的技术。


6. 系统抖动

7. 含义：在请求分页存储管理中，从主存（DRAM）中刚刚换出（Swap Out）某一页面后（换出到Disk），根据请求马上又换入（Swap In）该页，这种反复换出换入的现象，称为系统颠簸，也叫系统抖动。产生该现象的主要原因是置换算法选择不当。


1. 分区存储管理是把主存储器中的用户区作为一个连续区或分成若干个连续区进行管理，每个连续区中可装入一个作业。

2. 多道程序系统一般都采用多个分区的存储管理，具体可分为固定分区和可变分区两种方式。

3. 主存储器分为：*系统区和用户区*两个部分。
4. 存储管理是对主存空间的*用户区*进行管理。
5. 存储管理的目的：*方便用户和提高主存空间利用率*
6. 系统记录主存空间的分配情况：*建立一张主存空间分配表*
7. 主存分配表登记了各个分区的：*起始地址*和*长度*，并且占有一位*占用标记位*。
8. 可变分区*根据一张已分配表和一张空闲区表分配作业的主存空间*（他们两个组成了*主存分配表*）

9. 固定分区方式管理采用*静态重定位*方式装入作业；可变分区方式管理采用*动态重定位*方式装入作业。


8. 主存储器中以字节对应编址单位,这地址即是绝对地址;用户程序中的地址是逻辑地址

9. 重定位或者地址转换：*把逻辑地址转换成绝对地址的工作*

10. 所谓*程序浮动*，就是在程序运行过程中采取相对地址的技术来实现
11. 采用*动态重定位*的系统支持：*程序浮动*

12. 一个分区（即*单连续分区*）的存储管理：把存储器作为一个连续的分区分配给一个作业使用

13. 存储管理三种技术：

14. 手动的覆盖技术：
15. 目标是在较小的内存中运行较大的程序，常用于多道程序系统，与分区存储管理配合使用
16. 原理：
17. 把程序按照其自身逻辑结构，划分 为若干个功能上相对独立的程序模块，那些不会同时执行的模块共享一块内存区域，按时间先后来运行。
18. 必要部分（常用功能）的代码和数据驻内存
19. 可选部分（不常用功能）在其他程序模块中实现，平时存放在外存中，在需要用到时装入内存。

20. 自动的交换技术：
21. 目标
22. 多道程序在内存中时，让正在运行的程序或需要运行的程序获得更多的内存资源
23. 方法
24. 可将暂时不能运行的程序送入外存中，从而获得空闲内存空间
25. 操作系统把一个进程的整个地址空间的内容保存到外存中（换出），而将外存中的某个进程的地址空间读入内存中（换入），换入还出内容的大小为整个程序的地址空间。


8. 自动的虚拟存储技术
9. 如果想在有限的容量的内存中，以更小的页粒度为单位装入更多更大的程序，可以采用自动的虚拟存储技术

10. ———————————————


1. 多分区存储管理：*固定分区*和*可变分区*

2. 硬件中，设置*基址寄存器*配合完成地址转换；*限长寄存器*完成存储保护

3. *移动技术*：内存碎片指内存出现一些零散的小空闲区域，很难再利用，长此以往将造成严重的资源浪费。解决方法是移动所有的占用区域，使得空闲碎片合并成一整块连续区域，这一技术称为移动技术。

4. 采用移动技术时应减少移动的*作业数量*和*数据量*

5. 作业不可以移动的情况：*正在等待外围设备传输信息*。

6. 作业的页表：逻辑地址中的*页号*和主存中的*块号*的对应关系 

7. 页的大小是根据什么划分的那？这就追溯到内存的划分了。页的大小是根据内存中的块大小来划分的。什么是内存中的块那？下面解释一下块。页式存储空间将内存划分为等长的若干区域，每一个区域的大小一般取2的整数幂，每个区域就是一个块，块号从0开始编号，称为块号。分块的大小由什么确定的那？是有地址结构确定了主存储器的分块大小，这里不做解释。

8. 现在程序中的页与内存中的块就对应上了，地址结构确定块，块确定页，而页是有页号和页内地址组成的。

9. 页式存储管理的优点是将作业的连续逻辑地址空间划分成页，可以分配到内存中不连续的块中，也就是分配到内存的不连续的主存区域中，并且能使作业正确的执行，这样进一步的提高了主存空间的利用率。缺点是当处理器处理一个作业时，必须访问两次主存，第一次是*按页号读出页表中对应的块号*，第二次是*按计算出来的绝对地址进行读写*。
10. 第二次：*位移量加块号读出物理的实际地址*。

11. 页式存储管理提供*连续的*逻辑地址，而段式存储管理中段的逻辑地址是*不连续的*。

12. 段页式存储管理：

13. 用户作业采用分段结构后，不仅方便了编制程序（各模块可以独
14. 立编程），而且具有逻辑上清晰的优点。段式存储管理支持了用户的分段观点，但它的致命弱点是每段必须占据内存的连续区域。于是，在装入一个分段时，可能要移动已在内存的其他区域。为了克服这个缺点，可采用段页式存储管理。

15. 段页式存储管理要点是，用户作业仍采用分段结构，各模块可以独立编程，但操作系统在分配内存空间时，不是把一个段分配在一个连续的内存区域，而是把每段再分成等长的若干页，将内存分成和页大小相等的若干块，然后按页存放在若干可能不连续的内存块中。

16. 段页式存储管理兼顾了段式在逻辑上清晰和页式在存储管理上方便的优点。为了正确执行作业，段页式存储管理必须为每个作业建立一张段表,且对每一段建立一张页表。段表的长度由作业分段数决定，作业有多少段，段表的表目就有多少项；段表中每个表目指出本段所对应的页表的起始地址和页表的长度。页表的长度由对应段所分的页数决定 。页表的表目指出页号与内存块号的对应关系 。
17. ![Alt](https://i.loli.net/2020/09/12/oWRSPGrhTpvs2dV.jpg)

18. 段式存储管理地址重定位：
19. 先判断越界。
20. 绝对地址 = 段起始地址 + 段内地址

21. 分时操作系统：*允许多个用户以交互方式使用计算机*。

22. 操作系统：*管理计算机系统的资源和控制程序的运行*。
23. CPU调度算法：关于进程间的运行顺序

24. 实时操作系统有着极高的可靠性和安全性，*不强求系统资源的利用率*。
25. 软件操作系统由*程序和数据*组成。
26. 基本的操作系统：*批处理操作系统*、*分时操作系统*、*实时操作系统*。
27. 作业：*用户要求计算机系统中进行处理的一个计算机问题*。
28. 作业包含：*程序、相应的数据和作业说明书*。
29. 在批处理兼分时操作系统中，往往把由分时操作系统控制的作业成为*前台作业*，把由批处理系统控制的作业称为*后台作业*。

30. 操作系统的五大资源管理功能：处理器管理、存储管理、文件管理、设备管理、作业管理。

31. 磁盘机属于：*存储型设备*。

32. 存储型设备，输入输出操作的信息是以*块*为单位传输。
33. 输入输出设备，输入输出操作的信息是以*字符*为单位传输。

34. 用户程序中通常使用*设备类、相对号*提出使用设备的要求。

35. 二级存储（secondary storage，auxiliary storage）是计算机主存储器或内存之外的所有可访问数据存储器。

36. 磁盘速度有两部分：*传输速率*，*定位时间（随机访问时间）*。
37. 定位时间：*寻道时间（移动磁臂到所要柱面的所需时间）*、*旋转延迟时间（磁盘需要将目标扇区移动到磁头下的时间）*。

*传送时间*：执行一次磁头输入输出时，由磁头进行读写完成信息传送的时间。它是*硬件设计*时就固定的。

38. 通道是一种：*I/O处理机*。

39. 在一台共享设备上模拟若干台独享设备的操作，把独占设备变成逻辑上的共享设备，这种技术叫做虚拟设备技术。实现这种技术的软件和硬件被称为SPOOLING系统，使用SPOOLING技术所提供的设备就称为虚拟设备 。实现虚拟设备的条件是硬件要有大容量的缓冲区，软件要有预输入程序和缓输出程序，井管理程序 。优点是：1）提高了输入/输出的速度，缓和了CPU和低速I/O设备间的速度不匹配 ；2）将独占设备变为可共享的设备，设利用使率提高了 。

spooling是指*联机的外围设备同时操作*的意思。操作系统用它实现*虚拟设备*的功能。
spooling系统由*预输入程序*、*井管理程序*和*缓输出程序*组成。
SPOOL 系统设置一张*作业表*，用来登记输入井的各个作业的作业名、*作业状态* 、作业 拥有的文件数以及预输入表和缓输出表的位置等。
输入井中的作业有四种状态；输入状态、*收容状态*、执行状态和*完成状态*。
*收容状态*是指该作业的信息已经存放在输入井中，但尚未被选中执行。

如何实现spooling技术：
SPOOLing 技术首先需要提供统一的调用接口，每一个进程都可以调用该接口，这样在进程看了自己是拥有该设备的。
需要将磁盘设备和内存作为缓冲区，磁盘设备上的缓冲区称作*井*，而内存上的缓存区被称作缓冲区。
需要一个专门的输入输出进程来实现对 I/O 设备的读写数据。

![](media/15999714983646.png)

![](media/15999714983955.png)



计算机的外围设备可分为：*存储型设备*、*输入输出型设备*。
*存储型设备*能使大量的信息存放到相应的存储介质上，能作为主存储器的扩充。
*输入输出型设备*能把外界的信息输入到计算机系统，或把计算结果输出。

*输入输出操作*：主存储器与外围设备之间的信息传送操作。

存储型设备，输入输出的信息传输单位为*块*；对输入输出型设备，输入输出操作 的信息传输单位为*字符*。

只能让一个作业独占使用的设备称为*独占设备*。 
可以让几个作业同时使用的设备称为*共享设备*。

*绝对号*：计算机系统为每台设备确定一个编号，以便区分和识别，这个编号是确定的。
*相对号*：设备的______是用户在程序中定义的设备编号。

作业申请独占设备时，指定设备的方式有两种，1.指定设备的*绝对号*，2.另指定设备的 *设备类、相对号*。

*设备分配表*：操作系统用它记录计算机系统所配置的独占设备类型、台数和分配情况等。它由*设备类表*和*设备表*两部分组成。

要确定磁盘上一个块所在的位置必须给出三个参数：*柱面号*，*磁头号*、*扇区号*。

磁盘驱动调度由*移臂调度*和*旋转调度*两部分组成。

磁盘移臂调度算法中除了*先来先服务*调度算法外，其余三种调度算法都是根据欲访问 者的*柱面位置*来进行调度的。


![](media/15999895062221.jpg)

操作系统启动和控制外围设备完成输入输出操作的过程可分成三个阶段：准备阶段、 *启动I/O阶段*、*结束处理阶段*。

通道又被称为 I/O 处理器，它用于实现*cpu和外设*之间的信息传输。

实现虚拟设备必须要有一定的硬件和软件条件为基础，特别是硬件必须配置大容量的*磁盘*，要有中断装置和*通道*，具有*中央处理机与通道并行工作的能力*。


按文件用途分类，编译程序是*系统文件*。

*档案文件*是指将信息加工形成具有保留价值的文件。

文件系统的按名存取主要是通过*目录管理*实现的。
文件管理实际上是对*辅助存储空间*的管理。
逻辑文件可分为*流式文件*和*记录式文件*两类。
由一串信息组成，文件内信息不再划分可独立的单位，这是指*流式文件*。

记录式文件内可以独立存取的最小单位是由*数据项*组成的。
在随机存储方式中，用户以*数据项* 为单位对文件进行存取和检索。
数据库文件的逻辑结构形式是*记录式文件*。

能用来唯一标识某个逻辑记录的数据项为记录的 *主键*。
下列文件中，*顺序文件* 的物理结构不便于文件的扩充。
链接文件解决了顺序结构中存在的问题，它 *提高了存储空间的利用率*。（有一点像链表）
索引结构为每个文件建立一张索引表，用来存放 *逻辑记录存放位置的指针*。
文件是*逻辑存储单位*。

成组操作：
进行成组操作时必须使用主存缓冲区，缓冲区的长度等于*最大逻辑记录长度乘以组块因子*。
记录的成组和分解提高了存储介质的利用率，减少启动设备的次数，但 *以设立主存缓冲区和操作系统增加成组分解功能* 为代价。

有的系统为了方便用户，提供一种隐式使用文件的方法，但用户对*读文件*还是必须显式地提出。

用*存取控制表*可以防止共享文件可能造成的破坏，但实现起来系统开销太大。

单靠*规定文件使用权限*并不能达到文件保密的目的。

文件管理的主要工作是管理用户信息的存储、*检索*、更新、*共享*和保护。

操作系统实现文件管理后，允许用户对*记录式文件*进行存取的最小单位是*记录*。

从对文件信息的存取次序考虑，存取方法可分为*顺序存取*和*随机存取*两类。

用户按信息的使用和处理方式组成文件，称为*逻辑结构（或逻辑文件）*。
当用户要求读写文件时，文件系统实现*物理文件*和*逻辑文件*之间的转换。

在二级目录结构中，第一级为*主文件目录*，第二级为*用户文件目录*。
*相对路径名*指出了从当前目录出发到指定文件的路径。（注意区别于绝对路径）

逻辑文件可分为*流式文件*和*记录式文件*两类。

为了防止各种系统故障破坏文件，文件系统可以采用*建立副本*和*定时存储*两种方法对文件进 行保护。

*流式文件*是指用户对文件内的信息不再划分可独立的单位，整个文件由依次的一串信 息组成。
记录式文件中，*逻辑记录*是文件内可以独立存取的最小信息单位。

磁带上的每个文件都有文件头标、*文件信息*和*文件尾标*三部分组成。

在磁盘上常用的组织方式有*顺序结构*、*链接结构*和*索引结构*。

顺序文件把逻辑上连续的信息存放在磁盘相邻的块上，所以它不适于文件的*随机存取*。

为了防止用户共享文件时造成破坏，可以采用 *对文件进行加锁* 和 *对文件的访问权限进程分类*。

存取方式：
随机存取、顺序存取

文件的存取方式与*存储介质的特性*和*文件的物理结构*有关。

索引结构：
索引结构为每个文件建立一张*索引表*，把指示每个逻辑记录存放位置的指针集中在 这张表中。
在索引文件中随机存取某一记录时，根据*索引表*在主存中的起始地址找到该记录的登记项，再按其中的*指针*找到该逻辑记录。

记录的成组：
把若干逻辑记录合成一组存入一块的工作称*记录的成组*，每块中的逻辑记录个数称 *块因子*。

从一组逻辑记录中把一个逻辑记录分离出来的操作称为*记录的分解*。

位示图：
用*位示图*指示磁盘空间使用情况时，其中的每一位与一个*磁盘块*对应。

空闲块及其块表：
空闲块表中每个登记项记录一组连续空闲块的*首块号*和*块数*。
空闲块的连接方式有*单块连接*和*成组连接*。
采用空闲块成组连接方式时，把空闲块分成若干组，把指向一组空闲块的*指针*集 中在—起。
用户可以用访管指令调用建立文件、*打开文件*、读文件、*写文件*、关闭文件和 *删除文件*等文件操作的系统功能模块。
只有文件的*建立者*或*打开者*才有权关闭文件。

删除文件的操作：删除文件操作要把用户指定的文件在文件目录中*除名*，*收回*文件所占用的存储 空间。
用户在请求删除文件操作时必须先调用*关闭文件*操作模块。

管态和目态：

管态又叫特权态，系统态或核心态。CPU在管态下可以执行指令系统的全集。通常，操作系统在管态下运行。
目态又叫常态或用户态。机器处于目态时，程序只能执行非特权指令。用户程序只能在目态下运行，如果用户程序在目态下执行特权指令，硬件将发生中断，由操作系统获得控制，特权指令执行被禁止，这样可以防止用户程序有意或无意的破坏系统。
从目态转换为管态的唯一途径是中断。
从管态到目态可以通过修改程序状态字来实现，这将伴随这由操作系统程序到用户程序的转换。

UNIX 
unix的文件系统对盘空间的管理采用*空闲块成组链接法*。
UNIX 有许多特点，而*实时处理能力*不是 UNIX 的特点。
UNIX 系统中，进程控制块是*proc结构和user结构*。
UNIX 的物理文件采用了*多重索引文件*结构。  
unix的进程状态有：*就绪态*、*睡眠态*、*创建态*、*僵死态*。
unix操作系统的实存储管理方式：*界地址存储管理方式*
主要由于*UNIX 小部分由汇编大部分用 C 语言编写*原因，使 UNIX 易于移植。
UNIX 系统中，进程调度采用的技术是*动态优先数*
UNIX 系统中，文件存贮器管理采用的是*成组连接法*
UNIX 的 shell 有两层含义，一是指由 shell 命令组成的*shell命令*语言；二是*指该命令的解释*程序。 

碎片紧凑需要*动态重定位*的支持。

处理器执行程序时其指令地址由*程序状态字（PSW）*指出，通道执行通道程序时其首地址由*通道地址字（CAW）*指出。
通常把*通道程序的执行情况*记录在*CSW*中。

最早的操作系统是*批处理系统*。
中央处理器与外围设备的并行工作能力是由*硬件*提供的。
实现多道程序设计的前提条件是*处理机和外设并行操作*。

文件的物理结构方式是与*用户对文件的存取方式*有关的。

批处理作业必须向系统提交的一份作业说明书是用*作业控制语言*来表达的。

一个进程向其他进程发送信息时，应组织好一封信件，内容包括*发送者名*、*具体信息*、*等不等回信标志*、*回信存放地址*。

作业控制方式有*批处理（脱机）方式*和*交互式（联机，会话）方式*二种。

*死锁的定义*：如果所申请的资源被其他等待进程占有，那么该等待进程有可能再也无法改变其状态。
*引起死锁的原因*：
1.程序运行推进的顺序不合适
2.系统资源分配不当
3.系统资源不足

采用通道技术的计算机系统中，设备是通过*控制器*和*通道*与内存进行连接的。

常用的文件的物理组织形式主要有*顺序结构*、*链接结构*、*索引结构*、Hash结构、倒排结构等。
虚拟页式存储管理中，外存块的分配策略有两种，一种是*静态*分配，另一种是*动态*分配。
存储保护的手段有*防止地址越界*和*防止操作越权*。

进程之间的*低级通信*和*高级通信*统称进程通信，进程通信主要有两种模式：*共享内存模式*、*信息传递模式*。

共享型设备包括除*磁带机*以外的所有块型设备。

具有短进程优先处理、设备利用率高、系统开销小的处理机调度算法为*反馈排队法*。

*进程互斥*的硬件实现方式：1.测试并建立指令2.交换指令3.开关中断指令

下述操作系统分类中，*网络*和*分布式* 操作系统一定是由多台计算机组成的系统。

在下述存储管理方案中，*可变分区*和*固定分区* 管理方式要求作业的逻辑地址与占有主存的存储区域都是连续的。

计算机系统的软件资源包括程序和*操作系统*。

可防止死锁的资源分配策略有*预先分配策略*、*按序分配策略*、*剥夺式分配*。

什么叫驱动调度？其目的是什么？

*“驱动调度”*：系统采用一定的调度策略来决定各等待访问 I/O 设备任务的执行次序。
目的：降低访问者执行 I/O 操作的时间，增加单位时间内的 I/O 操作次数，提高系统效 率。

*实时性*不是分时系统的基本特征。

采用动态重定位方式装入的作业，在执行中允许*操作系统有条件地*将其移动。
分页式存储管理中，地址转换工作是由*硬件*完成的。

一个作业进入内存后，则所属该作业的进程初始时处于*就绪*状态

操作系统为用户提供两种类型的使用接口，它们是*操作员（或用户）*接口和*程序员（或程序）*接口。
操作系统中，进程可分为*系统*进程和*用户*进程两类。
用户调用*建立*和*打开*文件操作来申请对文件的使用权。
当一个进程独占处理器顺序执行时，具有两个特性：*封闭性*和*可再现性*。


*临界区*问题的三项要求：
1.互斥
2.前进
3.有限等待

Wait —-
Signal ++
Post ++

IPC:进程间通信机制

进程间通信：
1.共享内存 少量数据 需要来自内核的帮助
2.消息传递 常规的内存访问 

消息传递中：
1.直接通信 send(P,message )
2.间接通信 send(A,message) A：邮箱A A为两个进程所共享

同步：阻塞 异步：非阻塞

CPU调度处理：从就绪队列中选择进程并为之分配CPU的问题
FCFS：先到先服务调度算法
SJF：最短作业优先调度算法
RR：轮转法 是可抢占的

作业调度算法：
1.先来先服务
2.短作业优先
3.高响应比优先：
响应比=1+（等待时间/要求服务时间）

MFU：最常使用页置换算法
LFU：最不经常使用页置换算法
